<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <link rel="stylesheet" href="/assets/css/just-the-docs-default.css"> <link rel="stylesheet" href="/assets/css/just-the-docs-head-nav.css" id="jtd-head-nav-stylesheet"> <style id="jtd-nav-activation"> .site-nav > ul.nav-list:first-child > li > a, .site-nav > ul.nav-list:first-child > li > ul > li:not(:nth-child(2)) > a, .site-nav > ul.nav-list:first-child > li > ul > li > ul > li > a { background-image: none; } .site-nav > ul.nav-list:not(:first-child) a, .site-nav li.external a { background-image: none; } .site-nav > ul.nav-list:first-child > li:nth-child(6) > ul > li:nth-child(2) > a { font-weight: 600; text-decoration: none; }.site-nav > ul.nav-list:first-child > li:nth-child(6) > button svg, .site-nav > ul.nav-list:first-child > li:nth-child(6) > ul > li:nth-child(2) > button svg { transform: rotate(-90deg); }.site-nav > ul.nav-list:first-child > li.nav-list-item:nth-child(6) > ul.nav-list, .site-nav > ul.nav-list:first-child > li.nav-list-item:nth-child(6) > ul.nav-list > li.nav-list-item:nth-child(2) > ul.nav-list { display: block; } </style> <script src="/assets/js/vendor/lunr.min.js"></script> <script src="/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.8.0 --> <title>Parameter sweeps | YUPRA</title> <meta name="generator" content="Jekyll v3.9.5" /> <meta property="og:title" content="Parameter sweeps" /> <meta name="author" content="Jessica Birky" /> <meta property="og:locale" content="en_US" /> <link rel="canonical" href="http://localhost:4000/docs/tutorials/2_parameter_sweeps_with_stellar.html" /> <meta property="og:url" content="http://localhost:4000/docs/tutorials/2_parameter_sweeps_with_stellar.html" /> <meta property="og:site_name" content="YUPRA" /> <meta property="og:type" content="website" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="Parameter sweeps" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"WebPage","author":{"@type":"Person","name":"Jessica Birky"},"headline":"Parameter sweeps","url":"http://localhost:4000/docs/tutorials/2_parameter_sweeps_with_stellar.html"}</script> <!-- End Jekyll SEO tag --> </head> <body> <a class="skip-to-main" href="#main-content">Skip to main content</a> <svg xmlns="http://www.w3.org/2000/svg" class="d-none"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <!-- Feather. MIT License: https://github.com/feathericons/feather/blob/master/LICENSE --> <symbol id="svg-external-link" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-external-link"> <title id="svg-external-link-title">(external link)</title> <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <!-- Bootstrap Icons. MIT License: https://github.com/twbs/icons/blob/main/LICENSE.md --> <symbol id="svg-copy" viewBox="0 0 16 16"> <title>Copy</title> <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16"> <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"/> <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"/> </svg> </symbol> <symbol id="svg-copied" viewBox="0 0 16 16"> <title>Copied</title> <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard-check-fill" viewBox="0 0 16 16"> <path d="M6.5 0A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3Zm3 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3Z"/> <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1A2.5 2.5 0 0 1 9.5 5h-3A2.5 2.5 0 0 1 4 2.5v-1Zm6.854 7.354-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 0 1 .708-.708L7.5 10.793l2.646-2.647a.5.5 0 0 1 .708.708Z"/> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header" role="banner"> <a href="/" class="site-title lh-tight"> YUPRA </a> <button id="menu-button" class="site-button btn-reset" aria-label="Toggle menu" aria-pressed="false"> <svg viewBox="0 0 24 24" class="icon" aria-hidden="true"><use xlink:href="#svg-menu"></use></svg> </button> </div> <nav aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"><li class="nav-list-item"><a href="/" class="nav-list-link">Home</a></li><li class="nav-list-item"><a href="/docs/configuration.html" class="nav-list-link">Configuration</a></li><li class="nav-list-item"><a href="/docs/git_instructions.html" class="nav-list-link">Git Instructions</a></li><li class="nav-list-item"><a href="/docs/resources.html" class="nav-list-link">Resources</a></li><li class="nav-list-item"><a href="/docs/tasks.html" class="nav-list-link">Tasks</a></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Tutorials category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/docs/tutorials" class="nav-list-link">Tutorials</a><ul class="nav-list"><li class="nav-list-item"><a href="/docs/tutorials/1_introduction_to_stellar.html" class="nav-list-link">1. Intro to Stellar</a></li><li class="nav-list-item"><a href="/docs/tutorials/2_parameter_sweeps_with_stellar.html" class="nav-list-link">2. Parameter sweeps</a></li></ul></li></ul> </nav> <footer class="site-footer"> This site uses <a href="https://github.com/just-the-docs/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll. </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search" role="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search YUPRA" aria-label="Search YUPRA" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> </div> <div class="main-content-wrap"> <nav aria-label="Breadcrumb" class="breadcrumb-nav"> <ol class="breadcrumb-nav-list"> <li class="breadcrumb-nav-list-item"><a href="/docs/tutorials">Tutorials</a></li> <li class="breadcrumb-nav-list-item"><span>2. Parameter sweeps</span></li> </ol> </nav> <div id="main-content" class="main-content"> <main> <h2 class="no_toc text-delta" id="table-of-contents"> <a href="#table-of-contents" class="anchor-heading" aria-labelledby="table-of-contents"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Table of contents </h2> <ol id="markdown-toc"> <li><a href="#1-varying-simulation-parameters-with-vplanet_inference" id="markdown-toc-1-varying-simulation-parameters-with-vplanet_inference">1. Varying simulation parameters with <code class="language-plaintext highlighter-rouge">vplanet_inference</code></a></li> <li><a href="#2-performing-parameter-sweeps-with-vplanet_inference" id="markdown-toc-2-performing-parameter-sweeps-with-vplanet_inference">2. Performing parameter sweeps with <code class="language-plaintext highlighter-rouge">vplanet_inference</code></a></li> </ol> <p class="note">If you have not installed the packages <code class="language-plaintext highlighter-rouge">vplanet</code> and <code class="language-plaintext highlighter-rouge">vplanet_inference</code> you first need to install these.</p> <p>Import packages:</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">vplanet</span>

<span class="kn">import</span> <span class="nn">subprocess</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">from</span> <span class="nn">astropy</span> <span class="kn">import</span> <span class="n">units</span> <span class="k">as</span> <span class="n">u</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">rcParams</span>
<span class="n">rcParams</span><span class="p">[</span><span class="s">'font.family'</span><span class="p">]</span> <span class="o">=</span> <span class="s">'stixgeneral'</span>
<span class="n">rcParams</span><span class="p">[</span><span class="s">'text.usetex'</span><span class="p">]</span> <span class="o">=</span> <span class="bp">False</span>
<span class="n">rcParams</span><span class="p">[</span><span class="s">'xtick.labelsize'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">16</span>
<span class="n">rcParams</span><span class="p">[</span><span class="s">'ytick.labelsize'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">16</span>
<span class="n">rcParams</span><span class="p">[</span><span class="s">'axes.labelsize'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">16</span>

<span class="c1"># Create a directory to store our simulation configuration files
</span><span class="kn">import</span> <span class="nn">os</span>
<span class="n">temp_dir</span> <span class="o">=</span> <span class="s">"infile_templates"</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="n">exists</span><span class="p">(</span><span class="n">temp_dir</span><span class="p">):</span>
  <span class="n">os</span><span class="p">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">temp_dir</span><span class="p">)</span>
</code></pre></div></div> <h3 id="1-varying-simulation-parameters-with-vplanet_inference"> <a href="#1-varying-simulation-parameters-with-vplanet_inference" class="anchor-heading" aria-labelledby="1-varying-simulation-parameters-with-vplanet_inference"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 1. Varying simulation parameters with <code class="language-plaintext highlighter-rouge">vplanet_inference</code> </h3> <p>As you likely noticed working through the first tutorial <code class="language-plaintext highlighter-rouge">1_introduction_to_stellar</code>, it gets tedious to manually create new infiles for each new simulation you want to run and keep track of the proper unit conversions for each variable. While this workflow is okay for running just one or a few models, it is unsuitable if we want to say, run thousands of simulations to explore a parameter space, or do any inference to quantify parameter uncertainties. Fortunately this is where the package <code class="language-plaintext highlighter-rouge">vplanet_inference</code> comes in handy!</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">vplanet_inference</span> <span class="k">as</span> <span class="n">vpi</span>
</code></pre></div></div> <p><code class="language-plaintext highlighter-rouge">vplanet_inference</code> requires that we have a set of template infiles saved somewhere. We will call the directory containing the infiles the <code class="language-plaintext highlighter-rouge">inpath</code>.</p> <p>It also requires that we specify an <code class="language-plaintext highlighter-rouge">outpath</code> directory where infiles will be copied from <code class="language-plaintext highlighter-rouge">inpath</code> and written with the substituted parameters that we specify.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Specify the directory to read infile templates from
</span><span class="n">inpath</span> <span class="o">=</span> <span class="s">"infile_templates/stellar/baraffe_ribas/"</span>

<span class="c1"># Speficy the directory where infiles will be written to
</span><span class="n">outpath</span> <span class="o">=</span> <span class="s">"output/"</span>
</code></pre></div></div> <p>We can choose which variables in the infiles that we want to vary by creating a dictionary called <code class="language-plaintext highlighter-rouge">inparams</code>. The dict keys follow the convention <code class="language-plaintext highlighter-rouge">&lt;infile name&gt;.&lt;variable name&gt;</code> and the dict values specify the units for the variables using <code class="language-plaintext highlighter-rouge">astropy.units</code>.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Dictionary of input parameters and units
</span><span class="n">inparams</span> <span class="o">=</span> <span class="p">{</span><span class="s">"star.dMass"</span><span class="p">:</span> <span class="n">u</span><span class="p">.</span><span class="n">Msun</span><span class="p">,</span>
            <span class="s">"vpl.dStopTime"</span><span class="p">:</span> <span class="n">u</span><span class="p">.</span><span class="n">Gyr</span><span class="p">}</span>
</code></pre></div></div> <p>Similarly we can also create a dictionary called <code class="language-plaintext highlighter-rouge">outparams</code> which tells <code class="language-plaintext highlighter-rouge">vplanet_inference</code> which variables to add to our <code class="language-plaintext highlighter-rouge">saOutputOrder</code> for each body. The dict keys follow the convention <code class="language-plaintext highlighter-rouge">final.&lt;body name&gt;.&lt;variable name&gt;</code>, and the dict values use <code class="language-plaintext highlighter-rouge">astropy.units</code>.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Dictionary of output parameters and units
</span><span class="n">outparams</span> <span class="o">=</span> <span class="p">{</span><span class="s">"final.star.Radius"</span><span class="p">:</span> <span class="n">u</span><span class="p">.</span><span class="n">Rsun</span><span class="p">,</span>
             <span class="s">"final.star.Luminosity"</span><span class="p">:</span> <span class="n">u</span><span class="p">.</span><span class="n">Lsun</span><span class="p">}</span>
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Initialize the vplanet model
</span><span class="n">vpm</span> <span class="o">=</span> <span class="n">vpi</span><span class="p">.</span><span class="n">VplanetModel</span><span class="p">(</span><span class="n">inparams</span><span class="o">=</span><span class="n">inparams</span><span class="p">,</span>
                       <span class="n">outparams</span><span class="o">=</span><span class="n">outparams</span><span class="p">,</span>
                       <span class="n">inpath</span><span class="o">=</span><span class="n">inpath</span><span class="p">,</span>
                       <span class="n">outpath</span><span class="o">=</span><span class="n">outpath</span><span class="p">,</span>
                       <span class="n">timesteps</span><span class="o">=</span><span class="mf">1e6</span><span class="o">*</span><span class="n">u</span><span class="p">.</span><span class="n">yr</span><span class="p">,</span>
                       <span class="n">time_init</span><span class="o">=</span><span class="mf">5e6</span><span class="o">*</span><span class="n">u</span><span class="p">.</span><span class="n">yr</span><span class="p">,</span>
                       <span class="n">verbose</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</code></pre></div></div> <p>As an example, weâ€™ll compute the evolution of a sun-like star.</p> <p><code class="language-plaintext highlighter-rouge">theta</code> will be our array of values that we substitute in for the inparameters. These values should be the same order and units that we specified in our <code class="language-plaintext highlighter-rouge">inparams</code> dictionary.</p> <p>We can also optionally choose to save the written infiles to a specified <code class="language-plaintext highlighter-rouge">outsubpath</code> if we wish to inspect those later, such as for debugging. (If you run many simulations though, it is often better to say <code class="language-plaintext highlighter-rouge">remove=True</code> which deletes the infiles after the results are read. This will save you disk space.)</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Run the vplanet model
</span><span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">9.0</span><span class="p">])</span>
<span class="n">evol</span> <span class="o">=</span> <span class="n">vpm</span><span class="p">.</span><span class="n">run_model</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">remove</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">outsubpath</span><span class="o">=</span><span class="s">"solar_evol"</span><span class="p">)</span>
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">plt</span><span class="p">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">8</span><span class="p">,</span><span class="mi">6</span><span class="p">])</span>
<span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">evol</span><span class="p">[</span><span class="s">"Time"</span><span class="p">],</span> <span class="n">evol</span><span class="p">[</span><span class="s">"final.star.Luminosity"</span><span class="p">])</span>
<span class="n">plt</span><span class="p">.</span><span class="n">xscale</span><span class="p">(</span><span class="s">"log"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">yscale</span><span class="p">(</span><span class="s">"log"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div> <h3 id="2-performing-parameter-sweeps-with-vplanet_inference"> <a href="#2-performing-parameter-sweeps-with-vplanet_inference" class="anchor-heading" aria-labelledby="2-performing-parameter-sweeps-with-vplanet_inference"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 2. Performing parameter sweeps with <code class="language-plaintext highlighter-rouge">vplanet_inference</code> </h3> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
</code></pre></div></div> </main> </div> </div> <div class="search-overlay"></div> </div> </body> </html>
